#!/usr/bin/env groovy

//@Library('shared-lib') _ 
//@SharedLibrary('shared-lib') _
//checkout scm
//library identifier:"shared-lib"

pipeline{

    agent any
    tools {
        maven 'Maven'

    }
        
        stages{

              stage('sonar scan'){
                 environment {
	    		 	SCANNER_HOME = tool 'sonarScanner'
	  			  }
                  steps{
					 echo 'Build in progres'
			         withSonarQubeEnv('Sonar_Cloud') {
				       sh '${SCANNER_HOME}/bin/sonar-scanner -Dproject.settings=${SCANNER_HOME}/conf/sonar-scanner-cloud.properties'
			       
						}                      	  
                    
               	     }  
                 }	
                 
	             stage ('Check logs') {
	                steps {
	                	script{
	                    //filterLogs ('WARNING', 5)
	                    
	                    def rootDir = pwd()
                    	def example = load "${rootDir}/shared-lib/vars/filterLogs.groovy"
                    											  
	                    example.verify()
	                    }
	                }
	            }
		
           }	       	     	         
}